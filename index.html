<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Catálogo Mayorista</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
<style>
:root{
  --bg:#f6f8fb;
  --text:#222;
  --accent:#FFB800;      
  --accent-border:#FFD800;
  --muted:#b2b2b2;
  --card-border:#eee;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{background:var(--bg);font-family:Inter,system-ui,sans-serif}

/* Header Oferta */
.header-oferta{
  width:100%; background:var(--accent); color:var(--text);
  border-bottom:2px solid var(--accent-border);
  box-shadow:0 2px 10px rgba(0,0,0,.06);
  overflow:hidden; position:sticky; top:0; z-index:50;
}
.header-track{
  display:flex; gap:64px; white-space:nowrap;
  animation:marquee 24s linear infinite; padding:10px 0;
  font-weight:900; font-size:1.02rem; letter-spacing:.3px;
}
.header-item{display:inline-flex;align-items:center;gap:10px;padding-left:24px}
@keyframes marquee{ 0%{transform:translateX(0)} 100%{transform:translateX(-50%)} }

/* Layout */
.main{
  max-width:1600px; margin:0 auto;
  display:grid; grid-template-columns:260px 1fr; gap:18px; padding:16px 24px;
}
@media (max-width:992px){ .main{grid-template-columns:1fr} }

/* Sidebar */
.sidebar{
  background:#fff; border:1px solid var(--card-border); border-radius:12px;
  padding:14px; position:sticky; top:60px; height:max-content;
}
.sidebar h2{ margin:0 0 10px; font-size:1.02rem; font-weight:900; }
#menu-cat{display:flex; flex-direction:column; gap:8px}
.btn-cat{
  background:#fff; color:var(--accent); border:1.6px solid var(--accent-border);
  font-weight:700; border-radius:12px; padding:9px 12px; cursor:pointer; 
  font-size:.98rem; text-align:left; transition:.15s;
}
.btn-cat:hover, .btn-cat.active{
  background:var(--accent); color:var(--text); box-shadow:0 2px 8px rgba(255,216,0,.35)
}

/* Toolbar */
.toolbar{
  background:#fff; border:1px solid var(--card-border); border-radius:12px;
  padding:12px; display:flex; align-items:center; gap:12px; flex-wrap:wrap;
}
#searchBox{
  flex:1 1 300px; border:1.4px solid var(--accent-border);
  border-radius:12px; padding:10px 14px; font-size:1rem;
}

/* Grid */
.grid{display:grid; gap:18px; grid-template-columns:repeat(5,minmax(0,1fr))}
@media (max-width:1400px){.grid{grid-template-columns:repeat(4,1fr)}}
@media (max-width:992px){.grid{grid-template-columns:repeat(2,1fr)}}
@media (max-width:576px){.grid{grid-template-columns:repeat(1,1fr)}}

/* Card */
.card{
  background:#fff; border:1.3px solid var(--card-border); border-radius:14px;
  box-shadow:0 6px 18px rgba(255,216,0,.12); overflow:hidden; position:relative;
  display:flex; flex-direction:column; transition:transform 0.2s;
}
.card:hover{transform:translateY(-3px); box-shadow:0 10px 25px rgba(255,216,0,.25)}

.img-box{
  background:#faf7fc; padding:10px; display:flex; align-items:center; justify-content:center; height:200px;
}
.img-box img{max-width:100%; max-height:100%; object-fit:contain;}

.moq{
  position:absolute; top:10px; right:10px;
  background:var(--accent); color:var(--text);
  border-radius:8px; padding:4px 10px; font-weight:800; font-size:.85rem;
}

.info{padding:12px;}
.title{font-size:1rem; font-weight:800; margin:0 0 4px; line-height:1.3;}
.ref{font-size:.85rem; color:#666; font-weight:600; margin-bottom:10px;}
.prices{display:flex; align-items:center; gap:8px; flex-wrap:wrap;}
.price{font-weight:900; font-size:1.1rem; color:#111;}

.cta{
  background:var(--text); color:#fff; border-radius:6px; padding:4px 8px;
  font-weight:700; font-size:.8rem; display:flex; align-items:center; gap:4px;
}
.cta i{color:var(--accent);}

/* WhatsApp */
.whatsapp{
  position:fixed; right:20px; bottom:20px; z-index:100;
  background:#25D366; color:#fff; border-radius:50px; padding:12px 20px;
  font-weight:800; text-decoration:none; box-shadow:0 4px 12px rgba(0,0,0,.2);
  display:flex; align-items:center; gap:8px; transition:transform 0.2s;
}
.whatsapp:hover{transform:scale(1.05);}

@media (max-width:992px){
  .sidebar{position:static; margin-bottom:20px;}
  #menu-cat{flex-direction:row; flex-wrap:wrap;}
}
</style>
</head>
<body>

<div class="header-oferta">
  <div class="header-track">
    <div class="header-item"><i class="bi bi-truck"></i> Envíos a todo Bolivia</div>
    <div class="header-item"><i class="bi bi-stars"></i> Precios Mayoristas</div>
    <div class="header-item"><i class="bi bi-truck"></i> Envíos a todo Bolivia</div>
    <div class="header-item"><i class="bi bi-stars"></i> Precios Mayoristas</div>
    <div class="header-item"><i class="bi bi-truck"></i> Envíos a todo Bolivia</div>
  </div>
</div>

<div class="main">
  <aside class="sidebar">
    <h2>Categorías</h2>
    <div id="menu-cat">Cargando...</div>
  </aside>

  <section>
    <div class="toolbar">
      <i class="bi bi-search" style="color:#aaa"></i>
      <input id="searchBox" placeholder="Buscar producto...">
    </div>
    <div id="productos" class="grid"></div>
  </section>
</div>

<a class="whatsapp" href="https://wa.me/59161333335?text=Hola,%20quiero%20hacer%20un%20pedido." target="_blank">
  <i class="bi bi-whatsapp" style="font-size:1.2rem"></i> Realizar Pedido
</a>

<!-- Appwrite SDK -->
<script type="module">
import { Client, Databases, Query } from "https://cdn.jsdelivr.net/npm/appwrite@14.0.1/+esm";

const PROJECT_ID = '692ee6b70012153cd33c';
const DATABASE_ID = '692ee774002e9a3c8601';
const COLLECTION_ID = 'catalogo';

let todos = [];

async function iniciar(){
  const client = new Client()
    .setEndpoint('https://fra.cloud.appwrite.io/v1')
    .setProject(PROJECT_ID);

  const db = new Databases(client);
  const grid = document.getElementById('productos');

  try {
    // 1. Traemos los productos
    const res = await db.listDocuments(DATABASE_ID, COLLECTION_ID, [
      Query.limit(200),
      Query.orderDesc('$createdAt') 
    ]);
    
    // 2. FILTRO MÁGICO: Aquí es donde ocultamos los "Apagados"
    // Solo dejamos pasar los que NO tienen disponible=false
    todos = res.documents.filter(doc => doc.disponible !== false);

    renderCategorias();
    renderProductos(todos);

  } catch(e) {
    console.error(e);
    grid.innerHTML = `<p style="padding:20px; grid-column:1/-1; text-align:center;">Cargando catálogo...</p>`;
  }
}

function renderCategorias(){
  const menu = document.getElementById('menu-cat');
  const cats = ['Todo', ...new Set(todos.map(p => p.categoria || 'Varios'))];
  
  menu.innerHTML = cats.map(c => 
    `<button class="btn-cat ${c==='Todo'?'active':''}" onclick="filtrar('${c}', this)">${c}</button>`
  ).join('');
}

function renderProductos(lista){
  const grid = document.getElementById('productos');
  if(lista.length === 0){
    grid.innerHTML = `<p style="grid-column:1/-1; text-align:center; padding:40px; color:#666">No se encontraron productos disponibles.</p>`;
    return;
  }

  grid.innerHTML = lista.map(p => {
    return `
    <div class="card">
      <div class="moq">Min. ${p.moq || 6}</div>
      <div class="img-box">
        <img src="${p.imagen}" loading="lazy" alt="${p.descripcion}" onerror="this.src='https://via.placeholder.com/300?text=Sin+Foto'">
      </div>
      <div class="info">
        <h3 class="title">${p.descripcion}</h3>
        <div class="ref">Ref: ${p.codigo}</div>
        <div class="prices">
          <div class="price">Bs. ${p.preciopormayor}</div>
          ${p.precioUnidad ? `<div style="font-size:0.8rem; color:#888; text-decoration:line-through">Bs. ${p.precioUnidad}</div>` : ''}
        </div>
        <div style="margin-top:8px">
          <span class="cta"><i class="bi bi-fire"></i> PRECIO MAYOR</span>
        </div>
      </div>
    </div>`;
  }).join('');
}

window.filtrar = function(cat, btn){
  document.querySelectorAll('.btn-cat').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  if(cat === 'Todo') renderProductos(todos);
  else renderProductos(todos.filter(p => (p.categoria || 'Varios') === cat));
}

document.getElementById('searchBox').addEventListener('input', (e)=>{
  const q = e.target.value.toLowerCase();
  renderProductos(todos.filter(p => 
    (p.descripcion||'').toLowerCase().includes(q) || 
    (p.codigo||'').toLowerCase().includes(q)
  ));
});

iniciar();
</script>

</body>
</html>


